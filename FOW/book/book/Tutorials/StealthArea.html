<!DOCTYPE HTML>
<html lang="en" class="ayu" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Stealth Area - Layered Fog Of War documentation</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('ayu')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../documentation.html">Documentation</a></li><li class="chapter-item expanded "><a href="../../book/index.html">Book</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../book/getting_started.html">Getting Started</a></li><li class="chapter-item expanded "><a href="../../book/architecture/index.html">Architecture</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../book/architecture/Handler.html">Handler</a></li><li class="chapter-item expanded "><a href="../../book/architecture/Floor.html">Floor</a></li><li class="chapter-item expanded "><a href="../../book/architecture/Layers.html">Layers</a></li><li class="chapter-item expanded "><a href="../../book/architecture/Network.html">Network</a></li></ol></li><li class="chapter-item expanded "><a href="../../book/Template/index.html">Template</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../book/Template/MOBA.html">MOBA Template</a></li></ol></li><li class="chapter-item expanded "><a href="../../book/Tutorials/index.html">Tutorials</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../book/Tutorials/First_set_up.html">First set up</a></li><li class="chapter-item expanded "><a href="../../book/Tutorials/entities/index.html">Entities</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../book/Tutorials/entities/Collision_Entity.html">Collision entity</a></li><li class="chapter-item expanded "><a href="../../book/Tutorials/entities/Drawing_Entity.html">Drawing entity</a></li><li class="chapter-item expanded "><a href="../../book/Tutorials/entities/Visibility_Entity.html">Visibility Entity</a></li></ol></li><li class="chapter-item expanded "><a href="../../book/Tutorials/Rendering/index.html">Rendering</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../book/Tutorials/Rendering/HeatTexture.html">Heat Texture</a></li><li class="chapter-item expanded "><a href="../../book/Tutorials/Rendering/Material.html">Material</a></li><li class="chapter-item expanded "><a href="../../book/Tutorials/Rendering/Teams.html">Teams</a></li><li class="chapter-item expanded "><a href="../../book/Tutorials/Rendering/ToggleRender.html">Toggle Render</a></li></ol></li><li class="chapter-item expanded "><a href="../../book/Tutorials/FogChannels.html">Fog Channels</a></li><li class="chapter-item expanded "><a href="../../book/Tutorials/Floor_Verticality.html">Floor and Verticality</a></li><li class="chapter-item expanded "><a href="../../book/Tutorials/Layers.html">Layers</a></li><li class="chapter-item expanded "><a href="../../book/Tutorials/Minimap.html">Minimap</a></li><li class="chapter-item expanded "><a href="../../book/Tutorials/Networking.html">Networking</a></li><li class="chapter-item expanded "><a href="../../book/Tutorials/Outdoor_Indoor.html">Outdoor Indoor</a></li><li class="chapter-item expanded "><a href="../../book/Tutorials/StealthArea.html" class="active">Stealth Area</a></li></ol></li><li class="chapter-item expanded "><a href="../../book/Versions/index.html">Versions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../book/Versions/LFOW_V1.1.1.html">LFOW V1.1.1</a></li><li class="chapter-item expanded "><a href="../../book/Versions/LFOW_V1.2.0.html">LFOW V1.2.0</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../reference.html">C++ API Reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../reference/classes.html">Classes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../reference/classes/AFOW_Handler.html">AFOW_Handler</a></li><li class="chapter-item expanded "><a href="../../reference/classes/IFOW_CollisionEntity_Interface.html">IFOW_CollisionEntity_Interface</a></li><li class="chapter-item expanded "><a href="../../reference/classes/IFOW_DrawingEntity_Interface.html">IFOW_DrawingEntity_Interface</a></li><li class="chapter-item expanded "><a href="../../reference/classes/IFOW_Entity_Interface.html">IFOW_Entity_Interface</a></li><li class="chapter-item expanded "><a href="../../reference/classes/IFOW_GeometryEntity_Interface.html">IFOW_GeometryEntity_Interface</a></li><li class="chapter-item expanded "><a href="../../reference/classes/IFOW_VisibilityEntity_Interface.html">IFOW_VisibilityEntity_Interface</a></li><li class="chapter-item expanded "><a href="../../reference/classes/UFOW_CollisionHandler.html">UFOW_CollisionHandler</a></li><li class="chapter-item expanded "><a href="../../reference/classes/UFOW_DrawerComponent.html">UFOW_DrawerComponent</a></li><li class="chapter-item expanded "><a href="../../reference/classes/UFOW_Drawer_Shared.html">UFOW_Drawer_Shared</a></li><li class="chapter-item expanded "><a href="../../reference/classes/UFOW_EntityContainer.html">UFOW_EntityContainer</a></li><li class="chapter-item expanded "><a href="../../reference/classes/UFOW_EntityVisibilityHandler.html">UFOW_EntityVisibilityHandler</a></li><li class="chapter-item expanded "><a href="../../reference/classes/UFOW_Floor.html">UFOW_Floor</a></li><li class="chapter-item expanded "><a href="../../reference/classes/UFOW_LayerHandler.html">UFOW_LayerHandler</a></li><li class="chapter-item expanded "><a href="../../reference/classes/UFOW_LayerSetting.html">UFOW_LayerSetting</a></li><li class="chapter-item expanded "><a href="../../reference/classes/UFOW_Rasterizer.html">UFOW_Rasterizer</a></li><li class="chapter-item expanded "><a href="../../reference/classes/UFOW_TextureSample.html">UFOW_TextureSample</a></li><li class="chapter-item expanded "><a href="../../reference/classes/UFOW_Tile_Class.html">UFOW_Tile_Class</a></li><li class="chapter-item expanded "><a href="../../reference/classes/UFOW_VisibilityE_Component.html">UFOW_VisibilityE_Component</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Layered Fog Of War documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="stealth-area"><a class="header" href="#stealth-area">Stealth Area</a></h1>
<ul>
<li><a href="#add-stealth-area">Add Stealth Area</a></li>
<li><a href="#entities-settings">Entities settings</a>
<ul>
<li><a href="#collision">Collision</a></li>
<li><a href="#delegates">Delegates</a></li>
</ul>
</li>
<li><a href="#going-deeper">Going deeper</a></li>
</ul>
<p>This tutorial is about adding Stealth Area. No prerequisites are needed; you can use any map that you want.</p>
<h2 id="add-stealth-area"><a class="header" href="#add-stealth-area">Add Stealth Area</a></h2>
<p>The <code>Stealth Area</code> feature simulates the bush system found in MOBA games. The system acts as a collider and projects shadows if the
area is near an <code>FOVEntity</code>. Once the entity gets too close or inside, the collider will be ignored, and the fog will be revealed.
The system is fully dynamic, just like the collision system, and it will automatically generate <code>Clusters</code> of <code>Stealth Areas</code>. All
areas in contact will be added to a cluster, allowing the <code>FOVEntity</code> to reveal the fog from the whole cluster.</p>
<p><img src="../../assets/Tutorial/StealthArea/0_StealthAreaTutorial.png" alt="StealthAreaPictures" /></p>
<p>There are two different objects to generate a <code>Stealth Area</code>:</p>
<ul>
<li><code>UFOW_StealthAreaComponent</code>: You can attach it to any actor.</li>
<li><code>AFOW_PCG_StealthArea</code>: A predefined actor that generates a <code>Stealth Area</code> which can be filled procedurally with a <code>StaticMesh</code>.</li>
</ul>
<p>Both of these objects inherit from <code>IFOW_StealthArea_Interface</code>, allowing you to create your custom tool.<br /></p>
<p>Let's set it up by dropping an <code>AFOW_PCG_StealthArea</code> into your scene.</p>
<p><img src="../../assets/Tutorial/StealthArea/1_AddStealthArea.png" alt="StealthAreaPictures" /></p>
<p>As with <code>CustomCollision</code>, mobility is important for optimization, and you will need to manually place the vertices of the geometry
defining the area.</p>
<p><img src="../../assets/Tutorial/StealthArea/2_StealthAreaAreFOWCollisions.png" alt="StealthAreaPictures" /></p>
<p>Add vertices to the <code>Custom Geometry Vertices</code> and create the shape you want. All vertices need to have the same height; however, the
shape isn't limited.</p>
<p><img src="../../assets/Tutorial/StealthArea/3_AddVertices.png" alt="StealthAreaPictures" /></p>
<p>For the <code>AFOW_PCG_StealthArea</code>, you can provide a <code>StaticMesh</code>, and the system will fill the area geometry with instances of the provided mesh.</p>
<p><img src="../../assets/Tutorial/StealthArea/4_SelectPCGMesh.png" alt="StealthAreaPictures" /></p>
<p>You can tweak the generation with the following variables:</p>
<ul>
<li><code>Seed</code>: The seed used for randomness. -1 will use a different number for each generation.</li>
<li><code>Space Between</code>: The space separating each mesh.</li>
<li><code>Random Offset</code>: A random offset allowed for each instance to prevent alignment.</li>
<li><code>Rotation Min/Max</code>: The rotation range to apply to the mesh.</li>
<li><code>Scale Range</code>: The scale range to apply to the mesh.</li>
</ul>
<h2 id="entities-settings"><a class="header" href="#entities-settings">Entities Settings</a></h2>
<p>Aside from the <code>Stealth Area</code> itself, a few settings can be changed for the <code>Entities</code>.</p>
<h3 id="collision"><a class="header" href="#collision">Collision</a></h3>
<p>To discover the <code>Stealth Area</code> fog, the entities need to be in collision with them. This is computed with a <code>Circle-Geometry</code> intersection,
allowing users to define how large their units are and at what distance the units will be considered inside the <code>Stealth Area</code>. You will find
a <code>Collision Radius</code> variable in both <code>FOW_DrawingEntity_FOV_Component</code> and <code>FOW_VisibilityEntity_Component</code> to change the collision distance.<br />
For the <code>Visible Entities</code>, you will need to enable the <code>StealthAreaUpdate</code> by toggling on the variable. By design, it is set to false because
the collision chack can be expensive.</p>
<p><img src="../../assets/Tutorial/StealthArea/6_ChangeEntityCollisionRadius.png" alt="StealthAreaPictures" /></p>
<h3 id="delegates"><a class="header" href="#delegates">Delegates</a></h3>
<p>To associate gameplay with the <code>Stealth Area</code>, you can bind the <code>Entity</code> owner to the <code>OnEntityStealthStateChanged</code>.</p>
<p><img src="../../assets/Tutorial/StealthArea/8_OverrideOnStealthAreaChanged.png" alt="StealthAreaPictures" /></p>
<p>The delegate is simple and provides a boolean indicating whether the <code>Entity</code> has entered or left the <code>Stealth Area</code>.</p>
<p><img src="../../assets/Tutorial/StealthArea/9_BindToDelegate.png" alt="StealthAreaPictures" /></p>
<h2 id="going-deeper"><a class="header" href="#going-deeper">Going Deeper</a></h2>
<p>You might want to create gameplay that requires accessing the area actor within the <code>Stealth Area</code>. You can access the colliding area by calling
<code>GetStealthArea</code>. You can also query the other areas in the cluster with a chain of nodes:</p>
<ul>
<li>From the visibility entity, get the <code>StealthArea</code> and the <code>ClusterIdx</code> from it.</li>
<li>Get the <code>FOWHandler</code> and find the <code>Floors</code> at the entity's location.</li>
<li>Iterate over the floors and get the <code>EntityVisibilityHandler</code>.</li>
<li>Get the <code>StealthAreaContainer</code>.</li>
<li>Finally, call <code>GetStealthAreaForClusterIdx</code>, which will return an array of stealth area interfaces that you can cast.</li>
</ul>
<p><img src="../../assets/Tutorial/StealthArea/10_GoDeeperWithStealthArea.png" alt="StealthAreaPictures" /></p>
<hr />
<p><em>Documentation built with <a href="https://github.com/PsichiX/unreal-doc"><strong><code>Unreal-Doc</code> v1.0.9</strong></a> tool by <a href="https://github.com/PsichiX"><strong><code>PsichiX</code></strong></a></em></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../book/Tutorials/Outdoor_Indoor.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../book/Versions/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../book/Tutorials/Outdoor_Indoor.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../book/Versions/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
